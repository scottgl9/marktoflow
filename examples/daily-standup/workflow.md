---
workflow:
  id: daily-standup-summary
  name: "Daily Standup Summary"
  version: "1.0.0"
  description: "Aggregates team updates and generates a daily standup summary"
  author: "marktoflow"
  tags:
    - team
    - communication
    - scheduling

compatibility:
  agents:
    - claude-code: recommended
    - opencode: supported

requirements:
  tools:
    - slack
    - jira
  features:
    - tool_calling: required

triggers:
  - type: schedule
    cron: "0 9 * * 1-5"  # 9 AM on weekdays
    timezone: "America/New_York"

inputs:
  team_channel:
    type: string
    default: "#engineering"
    description: "Slack channel for the team"
  jira_project:
    type: string
    required: true
    description: "JIRA project key"
  lookback_hours:
    type: integer
    default: 24
    description: "Hours to look back for updates"

outputs:
  summary:
    type: string
    description: "Generated standup summary"
  active_issues:
    type: integer
    description: "Number of active issues"
---

# Daily Standup Summary

This workflow runs every weekday morning to collect team updates and generate
a standup summary that's posted to Slack.

## Step 1: Get Recent JIRA Updates

Fetch issues updated in the last 24 hours.

```yaml
action: jira.search
inputs:
  jql: "project = {{ inputs.jira_project }} AND updated >= -{{ inputs.lookback_hours }}h ORDER BY updated DESC"
  fields:
    - summary
    - status
    - assignee
    - updated
output_variable: recent_issues
```

## Step 2: Get In-Progress Work

Get all issues currently in progress.

```yaml
action: jira.search
inputs:
  jql: "project = {{ inputs.jira_project }} AND status = 'In Progress' ORDER BY assignee"
  fields:
    - summary
    - status
    - assignee
    - priority
output_variable: in_progress
```

## Step 3: Get Blocked Issues

Find any blocked or impediment issues.

```yaml
action: jira.search
inputs:
  jql: "project = {{ inputs.jira_project }} AND (status = 'Blocked' OR labels = 'blocked')"
  fields:
    - summary
    - assignee
    - comment
output_variable: blocked_issues
```

## Step 4: Get Recent Slack Activity

Fetch recent messages from the team channel.

```yaml
action: slack.get_messages
inputs:
  channel: "{{ inputs.team_channel }}"
  since_hours: "{{ inputs.lookback_hours }}"
  limit: 50
output_variable: slack_messages
```

## Step 5: Generate Summary

Use AI to generate a coherent standup summary.

```yaml
action: agent.generate
inputs:
  task: "standup_summary"
  context:
    recent_issues: "{{ recent_issues }}"
    in_progress: "{{ in_progress }}"
    blocked: "{{ blocked_issues }}"
    messages: "{{ slack_messages }}"
  template: |
    Generate a daily standup summary with the following sections:
    
    1. **What was completed yesterday** - Based on issues moved to Done
    2. **What's in progress today** - Current active work items
    3. **Blockers & Impediments** - Any issues that need attention
    4. **Team Highlights** - Notable discussions or announcements
    
    Keep it concise and actionable. Use bullet points.
    Tag relevant team members where appropriate.
output_variable: summary_content
```

## Step 6: Post to Slack

Post the generated summary to the team channel.

```yaml
action: slack.post_message
inputs:
  channel: "{{ inputs.team_channel }}"
  text: "{{ summary_content }}"
  blocks:
    - type: header
      text: ":sunrise: Daily Standup Summary"
    - type: section
      text: "{{ summary_content }}"
    - type: context
      elements:
        - type: mrkdwn
          text: "_Generated by marktoflow at {{ now | datetimeformat('%Y-%m-%d %H:%M') }}_"
output_variable: post_result
```

## Step 7: Set Outputs

```yaml
action: workflow.set_outputs
inputs:
  summary: "{{ summary_content }}"
  active_issues: "{{ in_progress | length }}"
```
